import pandas as pd

data = {
    "å§“å": ["å°æ˜", "å°çº¢", "å°åˆš", "å°ä¸½", "å°ç¾"],
    "å¹´é¾„": [18, 17, 18, 17, 19],
    "æˆç»©": [85, 92, 78, 88, 95],
    "åŸå¸‚": ["åŒ—äº¬", "ä¸Šæµ·", "å¹¿å·", "æ·±åœ³", "åŒ—äº¬"]
}

df = pd.DataFrame(data)
print(df)
# ğŸ§  ç»ƒä¹ é¢˜
# 1ï¸âƒ£ é€‰å‡ºæˆç»©åœ¨ 80 åˆ†ä»¥ä¸Šçš„å­¦ç”Ÿã€‚
# 2ï¸âƒ£ æ–°å¢ä¸€åˆ— â€œæ˜¯å¦æˆå¹´â€ï¼ˆå¹´é¾„ â‰¥ 18ï¼‰ã€‚
# 3ï¸âƒ£ åˆ é™¤ â€œåŸå¸‚â€ è¿™ä¸€åˆ—ã€‚
# 4ï¸âƒ£ æŒ‰æˆç»©ä»é«˜åˆ°ä½æ’åºã€‚
# 5ï¸âƒ£ è®¡ç®—æ¯ä¸ªåŸå¸‚çš„å¹³å‡æˆç»©ã€‚

# 1ï¸âƒ£ é€‰å‡ºæˆç»©åœ¨ 80 åˆ†ä»¥ä¸Šçš„å­¦ç”Ÿã€‚
test1=df[df["æˆç»©"]>80]
print(" 1ï¸âƒ£ é€‰å‡ºæˆç»©åœ¨ 80 åˆ†ä»¥ä¸Šçš„å­¦ç”Ÿ")
print(test1)
# 2ï¸âƒ£ æ–°å¢ä¸€åˆ— â€œæ˜¯å¦æˆå¹´â€ï¼ˆå¹´é¾„ â‰¥ 18ï¼‰ã€‚
df['æ˜¯å¦æˆå¹´'] = df['å¹´é¾„'] >= 18
# ğŸ’¡ å°ä¼˜åŒ–ï¼ˆå¦‚æœæƒ³è®© True/False æ›´æ˜“è¯»ï¼‰ï¼š
# df['æ˜¯å¦æˆå¹´'] = np.where(df['å¹´é¾„'] >= 18, 'æ˜¯', 'å¦')
print(" 2ï¸âƒ£ æ–°å¢ä¸€åˆ— â€œæ˜¯å¦æˆå¹´â€ï¼ˆå¹´é¾„ â‰¥ 18ï¼‰")
print(df)
# 3ï¸âƒ£ åˆ é™¤ â€œåŸå¸‚â€ è¿™ä¸€åˆ—ã€‚
df_deleted=df.drop(columns=["åŸå¸‚"])
print("ï¸ 3ï¸âƒ£ åˆ é™¤ â€œåŸå¸‚â€ è¿™ä¸€åˆ—")
print(df_deleted)
# 4ï¸âƒ£ æŒ‰æˆç»©ä»é«˜åˆ°ä½æ’åºã€‚
df_sort=df.sort_values(by="æˆç»©", ascending=False)
print("ï¸ 4ï¸âƒ£ æŒ‰æˆç»©ä»é«˜åˆ°ä½æ’åº")
print(df_sort)
# 5ï¸âƒ£ è®¡ç®—æ¯ä¸ªåŸå¸‚çš„å¹³å‡æˆç»©ã€‚
df_mean=df.groupby("åŸå¸‚")["æˆç»©"].mean()
# ğŸ’¡ å°ä¼˜åŒ–ï¼š
# å¯ä»¥ç›´æ¥æ˜¾ç¤ºâ€œå‰å‡ åâ€ï¼š
# df.nlargest(3, "æˆç»©")  # æˆç»©æœ€é«˜çš„å‰ä¸‰å
# ğŸ’¡ å°ä¼˜åŒ–ï¼ˆæ˜¾ç¤ºæˆ DataFrame è€Œé Seriesï¼‰ï¼š
# df_mean = df.groupby("åŸå¸‚", as_index=False)[["æˆç»©"]].mean()
print("ï¸ 5ï¸âƒ£ è®¡ç®—æ¯ä¸ªåŸå¸‚çš„å¹³å‡æˆç»©")
print(df_mean)

